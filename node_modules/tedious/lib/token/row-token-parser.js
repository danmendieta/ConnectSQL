// Generated by CoffeeScript 1.3.3
var parser, sprintf, valueParse;

valueParse = require('../value-parser');

sprintf = require('sprintf').sprintf;

parser = function(buffer, columnsMetaData) {
  var column, columnMetaData, columns, value, _i, _len;
  columns = [];
  for (_i = 0, _len = columnsMetaData.length; _i < _len; _i++) {
    columnMetaData = columnsMetaData[_i];
    value = valueParse(buffer, columnMetaData);
    column = {
      value: value,
      metadata: columnMetaData
    };
    columns.push(column);
    columns[columnMetaData.colName] = column;
  }
  return {
    name: 'ROW',
    event: 'row',
    columns: columns
  };
};

module.exports = parser;
